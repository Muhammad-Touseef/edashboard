<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OPS Board</title>
    <link rel="stylesheet" href="style.css">
    <link rel="shortcut icon" href="img/logo.png" type="image/x-icon">
    <link rel="stylesheet" href="js/bootstrap.min.css">
    <link rel="stylesheet" href="js/jquery-ui.css">
    <script src="js/pdf.js"></script>
    <script src="js/pdf.worker.js"></script>
    <script type="text/javascript" src="js/jquery-2.1.3.min.js"></script>
    <script type="text/javascript" src="js/xlsx.full.min.js"></script>
    <script type="text/javascript" src="js/jquery-ui.js"></script>
    <script type="text/javascript" src="js/popper.min.js"></script>
    <!-- <script type="text/javascript" src="js/jquery-2.1.3.min.js"></script> -->
    <script type="text/javascript">

        if (localStorage.getItem("Admin") == null) {
            window.location.replace("login.html");
        }
    </script>
<style type="text/css">
input,button{
    font-size: 12px;
    padding: 2px;
}


</style>

</head>

<body>
    <nav>
        <ul>
            <a href="index.html" target="index">
                <li>Main Dashboard</li>
            </a>
            <a href="permit.html" target="permit">
                <li>Permit Board</li>
            </a>
            <a href="pid.html" target="pid">
                <li>EVTL</li>
            </a>
            <a href="toxic.html" target="pid">
                <li style="font-size:17px;">Toxic and Radiation Contours</li>
            </a>
        </ul>
    </nav>
    <div class="home-content" style="display: flex;flex-direction: column;width: 100%;">

        <div class="section-boxes" id="ops">

            <div class="section-details" style="width:100%;">
                
                <div>
                    <h4 style="margin-top: 40px;">Execution Schedule Excel File</h4>
                    <div id="excel_dataES" title="Execution Schedule Excel File Data" class="mt-5"></div>                                     
                </div>
                <div>
                    <h4>DSCD Excel File</h4>               
                    <div id="excel_dataDSCD" class="mt-5"></div>                                     
                </div>
                <div>
                    <h4>Operations ROTA/ Shift Schedule Excel File </h4>                   
                    <div id="excel_dataOpp" class="mt-5"></div>                                     
                </div>
                <div>  
                    <h4>LOTO sheet Excel File </h4>                
                    <div id="excel_dataLOTO" class="mt-5"></div>                                     
                </div>
                <div>  
                    <h4>Notice Board Excel File</h4>                
                    <div id="excel_dataNB" class="mt-5"></div>                                     
                </div>
                <div>
                    <h4>Training Calendar Excel File</h4>
                    <div id="excel_dataTC" class="mt-5"></div>                                     
                </div>
                <div>
                    <h4>JSA/MOCs Excel File</h4>
                    <div id="excel_dataJSA" class="mt-5"></div>                                     
                </div>
                <div>
                    <div class="iframedivMSDS">
                      <div class="row">
                        <div class="col-12">
                          <h4>MSDS PDF</h4>
                          <iframe  height="1000" width="1500" name="plugin" id="embdLinkMSDS"></iframe>
                        </div>     
                      </div>     
                    </div>                                                      
                </div>
                <div>
                    <div class="iframedivEMR">
                      <div class="row">
                        <div class="col-12">
                          <h4>Emergency Contacts PDF</h4>
                          <iframe  height="1000" width="1500" name="plugin" id="embdLinkEMR"></iframe>
                        </div>     
                      </div>     
                    </div>
                    
                                                         
                </div>
                <!-- <iframe src=".pdf" id="pdfOne"">
    </iframe> -->
</div>
                
<div class=" recent-section box" style="flex:2;">
                    <div class="title">OPS Board</div>
                    <ul class="ops-box-container" style="cursor: auto;">
                        <li>
                            <div class="title ops-box">
                                
                                    Execution Schedule
                                    <p style="font-size: 10px;">
                                        For Excel
                                        <input type="file" id="excel_fileES">
                                        
                                    </p>
                                
                            </div>
                        </li>

                        <li>
                            <div class="title ops-box">
                                <a>
                                    DSCD<p style="font-size: 10px;">
                                        For Excel
                                        <input type="file" id="excel_fileDSCD">
                                        
                                    </p>
                                </a>
                            </div>
                        </li>
                        <li>
                            <div class="title ops-box" style="font-size: 20px;">
                                <a>
                                    Operations ROTA/ Shift Schedule
                                    <p style="font-size: 10px;">
                                        For Excel
                                        <input type="file" id="excel_fileOpp">
                                        
                                    </p>
                                </a>
                            </div>
                        </li>
                        <li>
                            <div class="title ops-box">
                                <a>
                                    LOTO sheet
                                    <p style="font-size: 10px;">
                                        For Excel
                                        <input type="file" id="excel_fileLOTO">
                                        
                                    </p>
                                </a>
                            </div>
                        </li>
                        <li>
                            <div class="title ops-box">
                                <a>
                                    Notice Board
                                    <p style="font-size: 10px;">
                                        For Excel
                                        <input type="file" id="excel_fileNB">
                                       
                                    </p>
                                </a>
                            </div>
                        </li>
                        <li>
                            <div class="title ops-box">
                                <a>
                                    Training Calendar
                                    <p style="font-size: 10px;">
                                        For Excel
                                        <input type="file" id="excel_fileTC">
                                        
                                    </p>
                                </a>
                            </div>
                        </li>
                        <li>
                            <div class="title ops-box">
                                <a>
                                    JSA/MOCs
                                    <p style="font-size: 10px;">
                                        For Excel
                                        <input type="file" id="excel_fileJSA">
                                        
                                    </p>
                                </a>
                            </div>
                        </li>
                        <li>
                            <div class="title ops-box">
                                <a>
                                    MSDS
                                    <p style="font-size: 10px;">
                                        
                                        For PDF
                                        <input name="file" type="file" class="" id="inputFileMSDS" />
                                        <button id="cancel-pdfMSDS">Cancel</button>
                                    </p>
                                </a>
                            </div>
                        </li>
                        <li>
                            <div class="title ops-box">
                                <a>
                                    Emergency Contacts
                                    <p style="font-size: 10px;">
                                        
                                        For PDF
                                        <input name="file" type="file" class="" id="inputFileEMR" />
                                        <button id="cancel-pdfEMR">Cancel</button>
                                    </p>
                                </a>
                            </div>
                        </li>
                    </ul>
            </div>


        </div>


    </div>


<script>
            
            var filename;
            $('#inputFileMSDS').change(function() {
              if (this.files[0].name != "") {
                filename = this.files[0]
                  $(".iframedivMSDS").show();
                  $("#cancel-pdfMSDS").show();
                $('#embdLinkMSDS')[0].src = window.URL.createObjectURL(new Blob([filename], {"type":"application/pdf"}));
              }
            });
            $(document).ready(function(){
              $("#cancel-pdfMSDS").click(function(){
                $(".iframedivMSDS").hide();
              });
            });

            var filename;
            $('#inputFileEMR').change(function() {
              if (this.files[0].name != "") {
                filename = this.files[0]
                  $(".iframedivEMR").show();
                  $("#cancel-pdfEMR").show();
                $('#embdLinkEMR')[0].src = window.URL.createObjectURL(new Blob([filename], {"type":"application/pdf"}));
              }
            });
            $(document).ready(function(){
              $("#cancel-pdfEMR").click(function(){
                // $(".iframedivEMR").hide();
                $("#inputFileEMR").val('');
                $("#embdLinkEMR").val('');
              });
            });

            $(document).ready(function(){
                
                $("#cancel-pdfMSDS").hide();
                $("#cancel-pdfEMR").hide();
              
                $(".iframedivMSDS").hide();
                $(".iframedivEMR").hide();
              
            });
 </script>


<script type="text/javascript">

    const excel_file = document.getElementById('excel_fileES');

    excel_file.addEventListener('change', (event) => {

    if(!['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.ms-excel'].includes(event.target.files[0].type))
    {
        document.getElementById('excel_dataES').innerHTML = '<div class="alert alert-danger">Only .xlsx or .xls file format are allowed</div>';

        excel_file.value = '';

        return false;
    }

    var reader = new FileReader();

    reader.readAsArrayBuffer(event.target.files[0]);

    reader.onload = function(event){

        var data = new Uint8Array(reader.result);

        var work_book = XLSX.read(data, {type:'array'});

        var sheet_name = work_book.SheetNames;

        var sheet_data = XLSX.utils.sheet_to_json(work_book.Sheets[sheet_name[0]], {header:1, defval: ""});

        if(sheet_data.length > 0)
        {
            var table_output = '<table class="table table-striped table-bordered">';

            for(var row = 0; row < sheet_data.length; row++)
            {

                table_output += '<tr>';

                for(var cell = 0; cell < sheet_data[row].length; cell++)
                {

                    if(row == 0)
                    {

                        table_output += '<th>'+sheet_data[row][cell]+'</th>';

                    }
                    else
                    {

                        table_output += '<td>'+sheet_data[row][cell]+'</td>';

                    }

                }

                table_output += '</tr>';

            }

            table_output += '</table>';

            document.getElementById('excel_dataES').innerHTML = table_output;
        }

        excel_file.value = '';

    }

    });

  </script>
<script type="text/javascript">

    const excel_fileDSCD = document.getElementById('excel_fileDSCD');

    excel_fileDSCD.addEventListener('change', (event) => {

    if(!['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.ms-excel'].includes(event.target.files[0].type))
    {
        document.getElementById('excel_dataDSCD').innerHTML = '<div class="alert alert-danger">Only .xlsx or .xls file format are allowed</div>';

        excel_fileDSCD.value = '';

        return false;
    }

    var reader = new FileReader();

    reader.readAsArrayBuffer(event.target.files[0]);

    reader.onload = function(event){

        var data = new Uint8Array(reader.result);

        var work_book = XLSX.read(data, {type:'array'});

        var sheet_name = work_book.SheetNames;

        var sheet_data = XLSX.utils.sheet_to_json(work_book.Sheets[sheet_name[0]], {header:1, defval: ""});

        if(sheet_data.length > 0)
        {
            var table_output = '<table class="table table-striped table-bordered">';

            for(var row = 0; row < sheet_data.length; row++)
            {

                table_output += '<tr>';

                for(var cell = 0; cell < sheet_data[row].length; cell++)
                {

                    if(row == 0)
                    {

                        table_output += '<th>'+sheet_data[row][cell]+'</th>';

                    }
                    else
                    {

                        table_output += '<td>'+sheet_data[row][cell]+'</td>';

                    }

                }

                table_output += '</tr>';

            }

            table_output += '</table>';

            document.getElementById('excel_dataDSCD').innerHTML = table_output;
        }

        excel_fileDSCD.value = '';

    }

    });

  </script>
<script type="text/javascript">

    const excel_fileOpp = document.getElementById('excel_fileOpp');

    excel_fileOpp.addEventListener('change', (event) => {

    if(!['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.ms-excel'].includes(event.target.files[0].type))
    {
        document.getElementById('excel_dataOpp').innerHTML = '<div class="alert alert-danger">Only .xlsx or .xls file format are allowed</div>';

        excel_fileOpp.value = '';

        return false;
    }

    var reader = new FileReader();

    reader.readAsArrayBuffer(event.target.files[0]);

    reader.onload = function(event){

        var data = new Uint8Array(reader.result);

        var work_book = XLSX.read(data, {type:'array'});

        var sheet_name = work_book.SheetNames;

        var sheet_data = XLSX.utils.sheet_to_json(work_book.Sheets[sheet_name[0]], {header:1, defval: ""});

        if(sheet_data.length > 0)
        {
            var table_output = '<table class="table table-striped table-bordered">';

            for(var row = 0; row < sheet_data.length; row++)
            {

                table_output += '<tr>';

                for(var cell = 0; cell < sheet_data[row].length; cell++)
                {

                    if(row == 0)
                    {

                        table_output += '<th>'+sheet_data[row][cell]+'</th>';

                    }
                    else
                    {

                        table_output += '<td>'+sheet_data[row][cell]+'</td>';

                    }

                }

                table_output += '</tr>';

            }

            table_output += '</table>';

            document.getElementById('excel_dataOpp').innerHTML = table_output;
        }

        excel_fileOpp.value = '';

    }

    });

  </script>
<script type="text/javascript">

    const excel_fileLOTO = document.getElementById('excel_fileLOTO');

    excel_fileLOTO.addEventListener('change', (event) => {

    if(!['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.ms-excel'].includes(event.target.files[0].type))
    {
        document.getElementById('excel_dataLOTO').innerHTML = '<div class="alert alert-danger">Only .xlsx or .xls file format are allowed</div>';

        excel_fileLOTO.value = '';

        return false;
    }

    var reader = new FileReader();

    reader.readAsArrayBuffer(event.target.files[0]);

    reader.onload = function(event){

        var data = new Uint8Array(reader.result);

        var work_book = XLSX.read(data, {type:'array'});

        var sheet_name = work_book.SheetNames;

        var sheet_data = XLSX.utils.sheet_to_json(work_book.Sheets[sheet_name[0]], {header:1, defval: ""});

        if(sheet_data.length > 0)
        {
            var table_output = '<table class="table table-striped table-bordered">';

            for(var row = 0; row < sheet_data.length; row++)
            {

                table_output += '<tr>';

                for(var cell = 0; cell < sheet_data[row].length; cell++)
                {

                    if(row == 0)
                    {

                        table_output += '<th>'+sheet_data[row][cell]+'</th>';

                    }
                    else
                    {

                        table_output += '<td>'+sheet_data[row][cell]+'</td>';

                    }

                }

                table_output += '</tr>';

            }

            table_output += '</table>';

            document.getElementById('excel_dataLOTO').innerHTML = table_output;
        }

        excel_fileLOTO.value = '';

    }

    });
 </script>
<script type="text/javascript">

    const excel_fileNB = document.getElementById('excel_fileNB');

    excel_fileNB.addEventListener('change', (event) => {

    if(!['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.ms-excel'].includes(event.target.files[0].type))
    {
        document.getElementById('excel_dataNB').innerHTML = '<div class="alert alert-danger">Only .xlsx or .xls file format are allowed</div>';

        excel_fileNB.value = '';

        return false;
    }

    var reader = new FileReader();

    reader.readAsArrayBuffer(event.target.files[0]);

    reader.onload = function(event){

        var data = new Uint8Array(reader.result);

        var work_book = XLSX.read(data, {type:'array'});

        var sheet_name = work_book.SheetNames;

        var sheet_data = XLSX.utils.sheet_to_json(work_book.Sheets[sheet_name[0]], {header:1, defval: ""});

        if(sheet_data.length > 0)
        {
            var table_output = '<table class="table table-striped table-bordered">';

            for(var row = 0; row < sheet_data.length; row++)
            {

                table_output += '<tr>';

                for(var cell = 0; cell < sheet_data[row].length; cell++)
                {

                    if(row == 0)
                    {

                        table_output += '<th>'+sheet_data[row][cell]+'</th>';

                    }
                    else
                    {

                        table_output += '<td>'+sheet_data[row][cell]+'</td>';

                    }

                }

                table_output += '</tr>';

            }

            table_output += '</table>';

            document.getElementById('excel_dataNB').innerHTML = table_output;
        }

        excel_fileNB.value = '';

    }

    });

  </script>
<script type="text/javascript">

    const excel_fileJSA = document.getElementById('excel_fileJSA');

    excel_fileJSA.addEventListener('change', (event) => {

    if(!['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.ms-excel'].includes(event.target.files[0].type))
    {
        document.getElementById('excel_dataJSA').innerHTML = '<div class="alert alert-danger">Only .xlsx or .xls file format are allowed</div>';

        excel_fileJSA.value = '';

        return false;
    }

    var reader = new FileReader();

    reader.readAsArrayBuffer(event.target.files[0]);

    reader.onload = function(event){

        var data = new Uint8Array(reader.result);

        var work_book = XLSX.read(data, {type:'array'});

        var sheet_name = work_book.SheetNames;

        var sheet_data = XLSX.utils.sheet_to_json(work_book.Sheets[sheet_name[0]], {header:1, defval: ""});

        if(sheet_data.length > 0)
        {
            var table_output = '<table class="table table-striped table-bordered">';

            for(var row = 0; row < sheet_data.length; row++)
            {

                table_output += '<tr>';

                for(var cell = 0; cell < sheet_data[row].length; cell++)
                {

                    if(row == 0)
                    {

                        table_output += '<th>'+sheet_data[row][cell]+'</th>';

                    }
                    else
                    {

                        table_output += '<td>'+sheet_data[row][cell]+'</td>';

                    }

                }

                table_output += '</tr>';

            }

            table_output += '</table>';

            document.getElementById('excel_dataJSA').innerHTML = table_output;
        }

        excel_fileJSA.value = '';

    }

    });

  </script>

</body>

</html>